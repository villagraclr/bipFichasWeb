@using SistemasBIPS.Models
@model PermisosViewModels
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Ministerio de Desarrollo Social - Gobierno de Chile";
}
@section styles {
    @Styles.Render("~/Content/Fonts_min")
    @Styles.Render("~/Content/DataTable")
}
<div id="page-wrapper">
    <div class="row">
        <ol class="breadcrumb breadcrumbBIPS">
            <li><a><i class="fa fa-gears fa-fw"></i> Mantenedores</a></li>
            <li class="active"><i class="fa fa-unlock-alt fa-fw"></i> Permisos</li>
        </ol>
    </div>
    <div class="row">
        <div class="col-lg-12" style="padding-left:0px;padding-right:0px">
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href="#usuarios" aria-controls="usuarios" role="tab" data-toggle="tab">Usuarios</a></li>
                <li role="presentation"><a href="#formularios" aria-controls="formularios" role="tab" data-toggle="tab">Formularios</a></li>
                <li role="presentation"><a href="#grupos" aria-controls="grupos" role="tab" data-toggle="tab">Grupos</a></li>
                <li role="presentation"><a href="#otros" aria-controls="otros" role="tab" data-toggle="tab">Otros</a></li>
            </ul>
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="usuarios">
                    <div class="table-responsive" style="margin-top: 10px;">
                        <table class="table table-striped table-bordered table-hover" cellspacing="0" id="tblUsuarios">
                            <thead>
                                <tr>
                                    <th>Usuario</th>
                                    <th>Nombre</th>
                                    <th>Ministerio</th>
                                    <th>Servicio</th>
                                    <th>Perfil</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane" id="formularios">
                    <div class="table-responsive" style="margin-top: 10px;">
                        <table class="table table-striped table-bordered table-hover" cellspacing="0" id="tblFormularios">
                            <thead>
                                <tr>
                                    <th>IdBips</th>
                                    <th>Ano</th>
                                    <th>Ministerio</th>
                                    <th>Servicio</th>
                                    <th>Tipo</th>
                                    <th>Nombre</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane" id="grupos">
                    <div class="table-responsive" style="margin-top: 10px;">
                        <table class="table table-striped table-bordered table-hover" cellspacing="0" id="tblGrupos">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Descripción</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane" id="otros">
                    <div class="form-horizontal" style="margin-top: 15px;">
                        <div class="form-group">
                            <label for="cmbAno" class="col-sm-3 control-label" style="padding-left:0px; padding-right:0px;">Año</label>
                            <div class="col-sm-9" style="padding-left:15px;">
                                <select id="cmbAno" class="form-control" style="width:70%;">
                                    <option value="-1">Seleccione</option>
                                    @if (Model.listaAnos.Count > 0)
                                    {
                                        foreach (var ano in Model.listaAnos)
                                        {
                                            <option value="@ano">@ano</option>
                                        }
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="cmbMinisterio" class="col-sm-3 control-label" style="padding-left:0px; padding-right:0px;">Ministerio</label>
                            <div class="col-sm-9" style="padding-left:15px;">
                                <select id="cmbMinisterio" class="form-control" style="width:70%;">
                                    <option value="-1">Seleccione</option>
                                    @foreach (var m in Model.listaMinistServ)
                                    {
                                        <option value="@m.Ministerios.IdParametro">@m.Ministerios.Descripcion</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="cmbServicio" class="col-sm-3 control-label" style="padding-left:0px; padding-right:0px;">Servicio</label>
                            <div class="col-sm-9" style="padding-left:15px;">
                                <select id="cmbServicio" class="form-control" style="width:70%;">
                                    <option value="-1">Seleccione</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="cmbTipo" class="col-sm-3 control-label" style="padding-left:0px; padding-right:0px;">Tipo</label>
                            <div class="col-sm-9" style="padding-left:15px;">
                                <select id="cmbTipo" class="form-control" style="width:70%;">
                                    <option value="-1">Seleccione</option>
                                    @foreach (var t in Model.tipos.Where(p => p.IdParametro != p.IdCategoria).ToList())
                                    {
                                        <option value="@t.IdParametro">@t.Descripcion</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                                <div class="col-md-6 col-md-offset-3">
                                    <button type="button" class="btn btn-primary" data-loading-text="Guardando..." id="btnGuardaOtrosPerm">Guardar</button>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Modal Formularios Grupos-->
<div id="modalPermisos" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Asignar permiso</h4>
            </div>
            <div class="modal-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label for="cmbPermisosForm" class="col-sm-4 control-label" style="padding-left:0px; padding-right:0px;">Permisos sobre formularios</label>
                        <div class="col-sm-8" style="padding-left:15px;">
                            <select id="cmbPermisosForm" class="form-control" style="width:80%;">
                                <option value="-1">Seleccione</option>
                                <option>Plantilla 1</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="cmbOtrosPermisos" class="col-sm-4 control-label" style="padding-left:0px; padding-right:0px;">Otros permisos</label>
                        <div class="col-sm-8" style="padding-left:15px;">
                            <select id="cmbOtrosPermisos" class="form-control" style="width:80%;">
                                <option value="-1">Seleccione</option>
                            </select>
                        </div>
                    </div>
                </div>                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" data-loading-text="Guardando..." id="btnGuardaPermisos">Guardar</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
@section scripts { 
    @Scripts.Render("~/bundles/DataTable")
    <script type="text/javascript">
        var aMinsServ = [];
        @foreach (var m in Model.listaMinistServ)
        {
            <text>
            var mi = {};
            mi.IdParametro = @m.Ministerios.IdParametro;
            var aServ = [];
        @foreach (var s in m.Servicios)
            {
                <text>
            var serv = {};
                serv.IdParametro = @s.IdParametro;
                serv.Descripcion = "@s.Descripcion";
                aServ.push(serv);
                </text>
            }
            mi.Servicios = aServ;
            aMinsServ.push(mi);
            </text>
        }
    </script>
    @Scripts.Render("~/bundles/Permisos")
}